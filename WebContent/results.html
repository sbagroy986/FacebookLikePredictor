<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Results &#8226; AP Project</title>
    <link rel="shortcut icon" href="http://www.google.com/s2/favicons?domain=www.iiitd.ac.in" type="image/x-icon">

    <!-- Bootstrap Core CSS -->
    <link href="./assets/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="./assets/css/small-business.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Page Content -->
    <div class="container">

        <!-- Heading Row -->
          <div class="row">
            <div class="col-md-12">
                <h1>Procedure</h1>
                <p>Implemented a basic Machine Learning algorithm to predict likes on a post, using the previous posts of a user.Since the algorithm had to be self-implemented (i.e, we could not use third-party ML libraries), we have used simple Linear Regression for this project.</p>
           		<p style="text-align:center;">h<sub>&#920;</sub>(x) = &#920;<sub>0</sub> + &#920;<sub>1</sub>x<sub>1</sub> + &#920;<sub>2</sub>x<sub>2</sub> + .... + &#920;<sub>n</sub>x<sub>n</sub> = X&#920;<sup>T</sup></p>
           		<p>Here, h<sub>&#920;</sub> is our hypothesis function. X is a mxn matrix where m is the number of data samples (number of posts, in this case) and n is the number of features. &#920; is a 1xn matrix which contains parameters (&#920;<sub>1</sub>,&#920;<sub>2</sub>...&#920;<sub>n</sub>) corresponding to each feature. This gives us h<sub>&#920;</sub>, an mx1 matrix which we cross-reference with the actual likes of the m corresponding posts to calculate accuracy.</p>
           		<p>We are extracting 14 features for each post. This list is (by no means) exhaustive. It's possible to go into much more detail but since we're short on time, we'll just cover these basic features: </p>
           		<div class="container">
           			<div class="row">
           				<div class="col-md-4">
			           		<ul>
								<li>People in (with the user) the post</li>
								<li>People tagged in the message</li>
								<li>Source of post (Categorical/One Hot Encoded)</li>
								<li>Presence of message</li>
								<li>Presence of description</li>
								<li>Presence of caption</li>
								<li>Length of message</li>
			           		</ul>           					
           				</div>
           				<div style="col-md-4">
			           		<ul>
								<li>Presence of location</li>
								<li>Type of post (Categorical/One Hot Encoded)</li>
								<li>Type of status (Categorical/One Hot Encoded)</li>
								<li>Created hour of day</li>
								<li>Created day of week</li>
								<li>Number of hashtags</li>
								<li>Number of emotes</li>
			           		</ul>           					
           				</div>
           			</div>
           		</div>
            </div>
            <!-- /.col-md-8 -->
            <!-- /.col-md-4 -->
        </div>
        <hr>
        <div class="row">
            <div class="col-md-12">
                <h1>Results</h1>
                <p>Using the data obtained from the Facebook graph API, we give you the following results:</p><br/><br/>
            </div>
            <div class="col-md-12" style="height:650px;">
                <div id="chart_div" style="height:600px;"></div>
            </div>
            <div class="col-md-6">
                <div id="curve_chart" style="width: 700px; height: 500px"></div>
            </div>
            <div class="col-md-4">
                <ul class="nav nav-tabs list-inline" style="margin-top:55px;">
                    <li><a data-toggle="tab" href="#menu0">3 likes</a></li>
                    <li class="active"><a data-toggle="tab" href="#menu1">5 likes</a></li>
                    <li><a data-toggle="tab" href="#menu2">10 likes</a></li>
                    <li><a data-toggle="tab" href="#menu3">15 likes</a></li>
                </ul>

                <div class="tab-content">
                  <div id="menu0" class="tab-pane fade in active">
                    <div id="donutchart-3" style="width: 700px; height: 500px;"></div>
                  </div>
                  <div id="menu1" class="tab-pane fade">
                    <div id="donutchart-5" style="width: 700px; height: 500px;"></div>
                  </div>
                  <div id="menu2" class="tab-pane fade">
                    <div id="donutchart-10" style="width: 700px; height: 500px;"></div>
                  </div>
                  <div id="menu3" class="tab-pane fade">
                    <div id="donutchart-15" style="width: 700px; height: 500px;"></div>
                  </div>
                </div>
            </div>
        </div>
        <!-- /.row -->

        <hr>

        <!-- Call to Action Well -->
        <div class="row">
            <div class="col-lg-12">
                <div class="well text-center">
                    <div id="three"></div>
                    <div id="five"></div>
                    <div id="ten"></div>
                    <div id="fif"></div>
                </div>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->

        <!-- Content Row -->
        <div class="row" id="posts">
        	<div class="col-md-8">
                <div class="panel panel-default">
                	<div class="panel-heading">
                		<h5>Post ID: <a href="#">1234</a></h5>
                	</div>
                    <div class="panel-body">
                        <p><img src="https://scontent.fdel1-2.fna.fbcdn.net/hphotos-xpa1/v/t1.0-9/1455970_480595362055180_1969038469_n.jpg?oh=eef8aaf027ed3c3ab4e0d89bb1cfc89b&oe=56F4E2B3" height="70px" width="70px;" class="img-circle pull-left" style="margin-right:20px; margin-bottom:1px;"> <a href="https://www.facebook.com/devilslayer986">Shrey Bagroy</a></p>
                        Design, build, test, and prototype using Bootstrap in real-time from your Web browser. Bootply combines the power of hand-coded HTML, CSS and JavaScript with the benefits of responsive design using Bootstrap. Find and showcase Bootstrap-ready snippets in the 100% free Bootply.com code repository.
                        <hr>
                        <div style="text-align:center">Actual likes:&nbsp;30&nbsp;<img src="http://www.brandsoftheworld.com/sites/default/files/styles/logo-thumbnail/public/102011/like_icon.png?itok=nkurUMlZ" height="18px" width="18px" style="margin-bottom:6px;margin-left:2px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Predicted likes:&nbsp;28&nbsp;<img src="https://image.freepik.com/free-icon/thumb-up-to-like-on-facebook_318-37196.png" height="18px" width="18px" style="margin-bottom:6px;margin-left:2px;"> </div>
					</div>
	           </div>
            </div>

       </div>
        <!-- /.row -->

        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
		            <p>CSE 121 &copy; AP</p>
                </div>
            </div>
        </footer>

    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="./assets/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="./assets/js/bootstrap.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1.1','packages':['bar','corechart']}]}"></script>
	<script type="text/javascript">
	window.onload = function() {
	};

    google.setOnLoadCallback(drawChart);
    function decode_utf8(s) {
 	 return decodeURIComponent(escape(s));
	}
    function drawChart() {
        var pie_data = google.visualization.arrayToDataTable([
          ['Correct', 'Incorrect'],
          ['Correct',     80],
          ['Incorrect',      20]
        ]);

        var options = {
          title: 'Accuracy (5 Likes Margin)',
          pieHole: 0.4,
        };

        var chart = new google.visualization.PieChart(document.getElementById('donutchart-3'));
        chart.draw(pie_data, options);

        var line_data = google.visualization.arrayToDataTable([
                  ['Year', 'Actual', 'Predicted'],
                  ['',  1000,      400],
                  ['',  1170,      460],
                  ['',  660,       1120],
                  ['',  1030,      540]
                ]);

                var options = {
                  title: 'Actual vs Predicted',
                  curveType: 'function',
                  legend: { position: 'bottom' }
                };

                var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

                chart.draw(line_data, options);

	    var x = document.cookie;
	    var tkns = x.split(';');
	    var d = [];
	    d.push(['People','Number of likes']);
    	var map = {};
	    for(var i=0;i<tkns.length;i++)
	    {
	    	if(tkns[i].split("=")[0] == "url")
	    	{
	    		map[(tkns[i].split("=")[0]).replace(" ","")] = decode_utf8(tkns[i].split("=")[1]);	    		
	    	}
	    	else
	    	{
	    		map[(tkns[i].split("=")[0]).replace(" ","")] = decode_utf8(tkns[i].split("=")[1]);
	    	}
	    	console.log(tkns[i]);
	    	console.log(tkns[i].split("=")[0]);
	    	console.log(tkns[i].split("=")[1]);

	    	if(tkns[i].indexOf("Histo--") > -1)
	    	{
	    		var k = tkns[i].split("--");
	    		var t = new Array(2);
	    		t[0] = k[1].split("=")[0];
	    		t[1] = parseInt(k[1].split("=")[1]);
	    		console.log(t[0] + " : " + t[1]);
	    		d.push(t);
	    	}
	    	if(tkns[i].indexOf("accuracy_15") > -1)
	    	{
	    		var k = tkns[i].split("accuracy_15=");
	    		var div = document.getElementById('fif');
	    		div.innerHTML += 'Accuracy for predicted likes within a 15 like margin : <b>'+parseFloat(k[1]).toPrecision(4)+'%</b><br/>';
	    	}
	    	if(tkns[i].indexOf("accuracy_10") > -1)
	    	{
	    		var k = tkns[i].split("accuracy_10=");
	    		var div = document.getElementById('ten');
	    		div.innerHTML += 'Accuracy for predicted likes within a 10 like margin : <b>'+parseFloat(k[1]).toPrecision(4)+'%</b><br/>';
	    	}
	    	if(tkns[i].indexOf("accuracy_5") > -1)
	    	{
	    		var k = tkns[i].split("accuracy_5=");
	    		var div = document.getElementById('five');
	    		div.innerHTML += 'Accuracy for predicted likes within a 5 like margin : <b>'+parseFloat(k[1]).toPrecision(4)+'%</b><br/>';
	    	}
	    	if(tkns[i].indexOf("accuracy_3") > -1)
	    	{
	    		var k = tkns[i].split("accuracy_3=");
	    		var div = document.getElementById('three');
	    		div.innerHTML += 'Accuracy for predicted likes within a 3 like margin : <b>'+parseFloat(k[1]).toPrecision(4)+'%</b><br/>';
	    	}

	    }

	    for(var i=1;i<=15;i++)
	    {
			// console.log(map['post_id_'])	    		
    		var div = document.getElementById("posts");
    		div.innerHTML += '<div class="col-md-8"><h5>Post ID: <a href="https://facebook.com/' + map['post_id_' + i] + '">' + map['post_id_' + i].split("_")[1] +'</a></h5><p>' + decode_utf8(map['post_msg_'+i]) + '</p><p>Actual likes: <b>' + map['post_likes_'+i] + '</b></p><p>Predicted likes: <b>' + map['post_pred_'+i] + '</b></p></div><br/><br/>'

	    }

		var data = google.visualization.arrayToDataTable(d);

	var options = {
		  chart: {
			 title: 'Top 15 expected likers',
			 subtitle: 'Based on the number of previous posts liked',
		  },
		  bar: { groupWidth: '90%' },
		  bars: 'horizontal',
	   };

	   var chart = new google.charts.Bar(document.getElementById('chart_div'));

	   chart.draw(data, options);
	 }
	  </script>
</body>

</html>
